import os

# --- 엑셀 파일 경로 설정 ---
# 앱 스크립트 (app.py)와 엑셀 파일 (로봇수술동의서.xlsx)이 동일한 디렉토리에 있다고 가정합니다.
EXCEL_FILE_PATH = os.path.join(os.path.dirname(__file__), "로봇수술동의서.xlsx")

# --- 로그인 정보 ---
USERNAME = "admin"
PASSWORD = "1234"

# --- 섹션별 셀 주소 정의 (진단명별로 다르게 지정) ---
# 이 맵은 로드된 엑셀 파일의 시트 이름과 셀 범위를 가리킵니다.
SECTION_CELL_MAP = {
    "necessity": {
        "자궁경부암": {"sheet": "산부인과로봇동의서", "ranges": ["C4", "D4"]},
        "난소암": {"sheet": "산부인과로봇동의서", "ranges": ["C4", "E4"]},
        "자궁내막암": {"sheet": "산부인과로봇동의서", "ranges": ["C4", "F4"]},
    },
    "method": {
        "자궁경부암": {"sheet": "산부인과로봇동의서", "ranges": ["C5", "D5", "C6", "D6", "C7", "C7"]},
        "난소암": {"sheet": "산부인과로봇동의서", "ranges": ["C5", "E5", "C6", "E6", "C7", "E7"]},
        "자궁내막암": {"sheet": "산부인과로봇동의서", "ranges": ["C5", "F5", "C6", "F6", "C7", "F7"]},
    },
    "considerations": {
        "자궁경부암": {"sheet": "산부인과로봇동의서", "ranges": ["C9", "D9", "D10","D11"]},
        "난소암": {"sheet": "산부인과로봇동의서", "ranges": ["C9", "E9", "E10", "E11"]},
        "자궁내막암": {"sheet": "산부인과로봇동의서", "ranges": ["C9", "F9", "F10", "F11"]},
    },
    "side_effects": {
        "자궁경부암": {"sheet": "산부인과로봇동의서", "ranges": ["C13", "D13", "C14"]},
        "난소암": {"sheet": "산부인과로봇동의서", "ranges": ["C13", "E13", "C14"]},
        "자궁내막암": {"sheet": "산부인과로봇동의서", "ranges": ["C13", "F13", "C14"]},
    },
    "precautions": {
        "자궁경부암": {"sheet": "산부인과로봇동의서", "ranges": ["C17","C18"]},
        "난소암": {"sheet": "산부인과로봇동의서", "ranges": ["C17","C18"]},
        "자궁내막암": {"sheet": "산부인과로봇동의서", "ranges": ["C17","C18"]},
    },
    "self_determination": {
        "자궁경부암": {"sheet": "산부인과로봇동의서", "ranges": ["C20"]},
        "난소암": {"sheet": "산부인과로봇동의서", "ranges": ["C20"]},
        "자궁내막암": {"sheet": "산부인과로봇동의서", "ranges": ["C20"]},
    },
}

# --- OX 퀴즈 데이터 ---
QUIZ_DATA = {
    "necessity": [
        {
            "question": "로봇수술은 배를 크게 열지 않고 작은 구멍으로만 수술해서 회복이 빠르다는 장점이 있어요. (O/X)",
            "answer": "O",
            "explanation": "네, 맞아요! 로봇수술은 최소 침습 수술이라 상처가 작고, 회복도 빨라요. 정말 잘 이해하셨네요! 😊"
        },
        {
            "question": "로봇수술은 꼭 필요한 경우에만 진행되며, 환자분의 상태를 꼼꼼히 확인하고 결정해요. (O/X)",
            "answer": "O",
            "explanation": "네, 맞아요! 어떤 수술이든 환자분께 가장 좋은 방법인지 의료진이 신중하게 판단해서 결정한답니다. 안심하세요! 💖"
        }
    ],
    "method": [
        {
            "question": "로봇수술은 의사 선생님이 직접 환자분의 배를 만지면서 수술하는 방식이에요. (O/X)",
            "answer": "X",
            "explanation": "아니요, 틀렸어요. 의사 선생님은 로봇 팔에 매달리는 게 아니라, 따로 앉아서 로봇 팔을 조종하며 수술하는 거예요. 그래도 의사 선생님이 직접 로봇을 움직이니 걱정하지 마세요! 👍"
        },
        {
            "question": "로봇수술은 사람의 눈으로 볼 수 없는 아주 작은 부위까지 확대해서 볼 수 있어서 더 정교하게 수술할 수 있어요. (O/X)",
            "answer": "O",
            "explanation": "네, 맞아요! 로봇은 사람의 눈보다 훨씬 더 자세히 볼 수 있게 도와줘서 수술이 더 섬세하게 진행될 수 있어요. 정말 똑똑하죠? ✨"
        }
    ],
    "considerations": [
        {
            "question": "수술 전에는 금식을 해야 하고, 의료진이 알려주는 주의사항을 꼭 지켜야 해요. (O/X)",
            "answer": "O",
            "explanation": "네, 맞아요! 금식과 의료진의 지시를 잘 따르면 더 안전하게 수술받을 수 있고 회복도 빨라진답니다. 잘 기억해 주세요! ✨"
        },
        {
            "question": "수술 전에는 건강 상태를 확인하기 위해 피검사나 심전도 검사 같은 여러 검사를 해요. (O/X)",
            "answer": "O",
            "explanation": "네, 맞아요! 환자분께 가장 안전한 수술을 해드리기 위해 몸 상태를 꼼꼼히 확인하는 과정이니 안심하세요. 😊"
        }
    ],
    "side_effects": [
        {
            "question": "모든 수술은 부작용이 전혀 없으므로 걱정할 필요가 없어요. (O/X)",
            "answer": "X",
            "explanation": "아니요, 틀렸어요. 모든 수술은 아주 작은 확률이라도 부작용이 생길 수 있어요. 하지만 의료진이 부작용을 최소화하기 위해 최선을 다하고, 혹시 생기더라도 잘 대처할 준비가 되어 있으니 너무 걱정 마세요. 저희가 함께할 거예요! 💖"
        },
        {
            "question": "수술 후 열이 나거나 수술 부위가 아프면 그냥 참지 말고 의료진에게 바로 알려야 해요. (O/X)",
            "answer": "O",
            "explanation": "네, 맞아요! 불편한 점이 있다면 언제든지 저희에게 이야기해주세요. 환자분의 편안한 회복을 돕는 것이 저희의 역할이랍니다! 🏥"
        }
    ],
    "precautions": [
        {
            "question": "수술 후에는 바로 집으로 돌아가서 하고 싶은 것을 다 해도 괜찮아요. (O/X)",
            "answer": "X",
            "explanation": "아니요, 틀렸어요. 수술 후에는 몸이 회복될 시간이 필요해요. 의료진이 알려주는 회복 기간 동안은 무리하지 않고 충분히 쉬는 것이 중요해요. 궁금한 점이 있다면 언제든지 저희에게 물어보세요! 🏥"
        },
        {
            "question": "수술 후에는 가벼운 걷기 운동부터 시작해서 몸이 회복되는 것을 도와주는 것이 좋아요. (O/X)",
            "answer": "O",
            "explanation": "네, 맞아요! 천천히 몸을 움직여주는 것이 회복에 도움이 돼요. 너무 무리하지 않는 선에서 움직여주세요. 💪"
        }
    ],
    "self_determination": [
        {
            "question": "수술 동의서에 서명하면 환자는 수술에 대해 아무것도 물어볼 수 없어요. (O/X)",
            "answer": "X",
            "explanation": "아니요, 틀렸어요. 동의서에 서명하더라도 수술에 대해 궁금한 점이 있다면 언제든지 물어보고 자세한 설명을 들을 수 있어요. 환자분의 마음이 편안한 것이 가장 중요하답니다! 🫂"
        },
        {
            "question": "수술 동의서의 내용을 모두 이해했는지 확인하고 서명하는 것이 중요해요. (O/X)",
            "answer": "O",
            "explanation": "네, 맞아요! 환자분께서 내용을 정확히 알고 동의하시는 것이 가장 중요하답니다. 혹시라도 궁금한 점이 있다면 언제든지 다시 물어봐주세요. 🤝"
        }
    ],
}

# --- 자주 묻는 질문 데이터 (FAQ) ---
FAQ_DATA = {
    "necessity": [
        "1. 로봇수술 말고 다른 수술 방법은 없나요?",
        "2. 로봇수술을 꼭 해야만 하는 건가요?",
        "3. 만약 수술을 안 하면 어떻게 되나요?"
    ],
    "method": [
        "1. 수술 시간은 얼마나 걸리나요?",
        "2. 로봇이 혼자서 수술하는 건가요?",
        "3. 수술 후 흉터는 얼마나 남나요?"
    ],
    "considerations": [
        "1. 수술 전에 꼭 준비해야 할 것이 있나요?",
        "2. 금식은 왜 해야 하나요?",
        "3. 수술 전 복용하던 약은 어떻게 해야 하나요?"
    ],
    "side_effects": [
        "1. 수술 후 통증은 얼마나 심한가요?",
        "2. 예상치 못한 다른 부작용은 없나요?",
        "3. 부작용이 생기면 어떻게 대처해주시나요?"
    ],
    "precautions": [
        "1. 수술 후 언제부터 음식을 먹을 수 있나요?",
        "2. 퇴원 후 집에서 주의해야 할 점은 무엇인가요?",
        "3. 언제부터 운동을 다시 시작할 수 있나요?"
    ],
    "self_determination": [
        "1. 동의서 내용을 나중에 다시 볼 수 있나요?",
        "2. 수술 동의를 철회할 수도 있나요?",
        "3. 가족들도 동의서 설명을 함께 들을 수 있나요?"
    ]
}

# 사이드바 섹션 매핑
SECTIONS_SIDEBAR_MAP = {
    "necessity": {"title": "수술 필요성", "idx": 1},
    "method": {"title": "수술 방법", "idx": 2},
    "considerations": {"title": "고려사항", "idx": 3},
    "side_effects": {"title": "합병증과 관리", "idx": 4},
    "precautions": {"title": "주의사항", "idx": 5},
    "self_determination": {"title": "자기결정권", "idx": 6},
}

# 섹션 순서 (이전/다음 버튼 등에 사용)
SECTIONS_ORDER_KEYS = ["necessity", "method", "considerations", "side_effects", "precautions", "self_determination"]